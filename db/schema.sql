DROP TABLE IF EXISTS todo_item;
DROP TABLE IF EXISTS todo_list;
DROP TABLE IF EXISTS account;

CREATE TABLE account (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
    password_hash CHAR(60) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
        ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE todo_list (
    id INT PRIMARY KEY AUTO_INCREMENT,
    account_id INT NOT NULL,
    name VARCHAR(50) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
        ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (account_id) REFERENCES account(id)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE todo_item (
    id INT PRIMARY KEY AUTO_INCREMENT,
    todo_list_id INT NOT NULL,
    description VARCHAR(100) NOT NULL,
    completed BOOLEAN NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (todo_list_id) REFERENCES todo_list(id)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);
